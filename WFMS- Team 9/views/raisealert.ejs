<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="">
    <meta name="author" content="">
    <title>Alert</title>
	<link rel="icon" href="images/favicon.ico">
    <!-- Bootstrap Core CSS -->
    <link href="/css/bootstrap.css" rel="stylesheet">

    <!-- Custom CSS -->
    <link href="/css/admin.css" rel="stylesheet">

    <!-- Morris Charts CSS -->
    <link href="/css/plugins/morris.css" rel="stylesheet">

   <!-- Custom Fonts -->
<    <link href="/font-awesome/css/font-awesome.min.css" rel="stylesheet" type="text/css">	
    		 <link rel="stylesheet" href="/styles/kendo.common.min.css" />
    <link rel="stylesheet" href="/styles/kendo.moonlight.min.css" />
    <link rel="stylesheet" href="/styles/kendo.dataviz.min.css" />
    <link rel="stylesheet" href="/styles/kendo.dataviz.moonlight.min.css" />
    <link rel="stylesheet" href="/styles/kendo.moonlight.mobile.min.css" /> 
    <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
        <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
        <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
    <![endif]-->
	<style>
	#header-page{
	background-image: url("textures/brushed-metal.png");
  background-image: url("textures/brushed-metal.png"),-webkit-linear-gradient(top,#2f3640 0,#212a33 100%);
  background-image: url("textures/brushed-metal.png"),-moz-linear-gradient(top,#2f3640 0,#212a33 100%);
  background-image: url("textures/brushed-metal.png"),-o-linear-gradient(top,#2f3640 0,#212a33 100%);
  background-image: url("textures/brushed-metal.png"),linear-gradient(to bottom,#2f3640 0,#212a33 100%);
  background-position: 50% 50%;
  background-color: #212a33;
  border-color: #171e28;
  color:#fff;
  }
  	#modalheader-page{
	margin-left:5px;
	margin-right:5px;
	background-image: url("textures/brushed-metal.png");
  background-image: url("textures/brushed-metal.png"),-webkit-linear-gradient(top,#2f3640 0,#212a33 100%);
  background-image: url("textures/brushed-metal.png"),-moz-linear-gradient(top,#2f3640 0,#212a33 100%);
  background-image: url("textures/brushed-metal.png"),-o-linear-gradient(top,#2f3640 0,#212a33 100%);
  background-image: url("textures/brushed-metal.png"),linear-gradient(to bottom,#2f3640 0,#212a33 100%);
  background-position: 50% 50%;
  background-color: #212a33;
  border-color: #171e28;
  color:#fff;
	}
  
  #pvGrid .k-grid-header .k-header
{
      color: #ee9f05;
}
  #incidentGrid .k-grid-header .k-header
{
      color: #ee9f05;
}
  #csGrid .k-grid-header .k-header
{
      color: #ee9f05;
}
  #msGrid .k-grid-header .k-header
{
      color: #ee9f05;
}

h5{
font-weight:bold;
font-size:14px;
}
	</style>
</head>

<body>

    <div id="wrapper" ng-app="wfms" ng-controller="guard">

        <!-- Navigation -->
        <nav class="navbar navbar-inverse navbar-fixed-top" role="navigation">
            <!-- Brand and toggle get grouped for better mobile display -->
            <div class="navbar-header">
                <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-ex1-collapse">
                    <span class="sr-only">Toggle navigation</span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                </button>
        <a class="navbar-brand" href="/guard" style=""><img src="images/logos2.png" style="height:40px;width:120px;"/></a>
            </div>
            <!-- Top Menu Items -->
            <ul class="nav navbar-right top-nav">
                <li class="dropdown">
                    <a href="#" class="dropdown-toggle" data-toggle="dropdown"><i class="fa fa-envelope"></i> <b class="caret"></b></a>
                    <ul class="dropdown-menu message-dropdown">
                        <li class="message-preview">
                            <a href="#">
                                <div class="media">
                                    <span class="pull-left">
                                      
                                    </span>
                                    <div class="media-body">
                                        <h5 class="media-heading"><strong>John Smith</strong>
                                        </h5>
                                        <p class="small text-muted"><i class="fa fa-clock-o"></i> Yesterday at 4:32 PM</p>
                                        <p>Lorem ipsum dolor sit amet, consectetur...</p>
                                    </div>
                                </div>
                            </a>
                        </li>
                        <li class="message-preview">
                            <a href="#">
                                <div class="media">
                                    <span class="pull-left">
                                        <img class="media-object" src="http://placehold.it/50x50" alt="">
                                    </span>
                                    <div class="media-body">
                                        <h5 class="media-heading"><strong>John Smith</strong>
                                        </h5>
                                        <p class="small text-muted"><i class="fa fa-clock-o"></i> Yesterday at 4:32 PM</p>
                                        <p>Lorem ipsum dolor sit amet, consectetur...</p>
                                    </div>
                                </div>
                            </a>
                        </li>
                        <li class="message-preview">
                            <a href="#">
                                <div class="media">
                                    <span class="pull-left">
                                        <img class="media-object" src="http://placehold.it/50x50" alt="">
                                    </span>
                                    <div class="media-body">
                                        <h5 class="media-heading"><strong>John Smith</strong>
                                        </h5>
                                        <p class="small text-muted"><i class="fa fa-clock-o"></i> Yesterday at 4:32 PM</p>
                                        <p>Lorem ipsum dolor sit amet, consectetur...</p>
                                    </div>
                                </div>
                            </a>
                        </li>
                        <li class="message-footer">
                            <a href="#">Read All New Messages</a>
                        </li>
                    </ul>
                </li>
                <li class="dropdown">
                    <a href="#" class="dropdown-toggle" data-toggle="dropdown"><i class="fa fa-bell"></i> <b class="caret"></b></a>
                    <ul class="dropdown-menu //alert-dropdown">
                        <li>
                            <a href="#">//alert Name <span class="label label-default">//alert Badge</span></a>
                        </li>
                        <li>
                            <a href="#">//alert Name <span class="label label-primary">//alert Badge</span></a>
                        </li>
                        <li>
                            <a href="#">//alert Name <span class="label label-success">//alert Badge</span></a>
                        </li>
                        <li>
                            <a href="#">//alert Name <span class="label label-info">//alert Badge</span></a>
                        </li>
                        <li>
                            <a href="#">//alert Name <span class="label label-warning">//alert Badge</span></a>
                        </li>
                        <li>
                            <a href="#">//alert Name <span class="label label-danger">//alert Badge</span></a>
                        </li>
                        <li class="divider"></li>
                        <li>
                            <a href="#">View All</a>
                        </li>
                    </ul>
                </li>
                <li class="dropdown">
                    <a href="#" class="dropdown-toggle" data-toggle="dropdown"><i class="fa fa-user"></i> Sairam Nutheti <b class="caret"></b></a>
                    <ul class="dropdown-menu">
                        <li>
                            <a href="#"><i class="fa fa-fw fa-user"></i>Edit Profile</a>
                        </li>
                        <!-- <li>
                            <a href="#"><i class="fa fa-fw fa-envelope"></i> Inbox</a>
                        </li> -->
                        <li>
                            <a href="#"><i class="fa fa-fw fa-gear"></i> Settings</a>
                        </li>
                        <li class="divider"></li>
                        <li>
                            <a href="#"><i class="fa fa-fw fa-power-off"></i> Log Out</a>
                        </li>
                    </ul>
                </li>
            </ul>
         
            <div class="collapse navbar-collapse navbar-ex1-collapse">
			
                <ul class="nav navbar-nav side-nav" >
					<li><h5 style="margin-top:15px;padding-left:20px;padding-bottom:10px;color:#fff;"><i class="fa fa-bars"></i> Navigation</h5></li>
                    <li>
                            <a href="/guard"><i class="fa fa-dashboard fa-fw"></i> Log Report</a>
                        </li>
					    <li class="active">
                            <a href="/alert"><i class="fa fa-lightbulb-o"></i> Raise alert</a>							
                        </li>
						 <li>
                            <a href="/viewschedule"><i class="fa fa-calendar fa-fw"></i> Schedule</a>							
                        </li>
                         <li>
                            <a href="/submitreport"><i class="fa fa-shield fa-fw"></i> Submit Report</a>							
                        </li>                      
                </ul>
            </div>
            <!-- /.navbar-collapse -->
        </nav>

        <div id="page-wrapper">

            <div class="container-fluid">
			
                <!-- Page Heading -->
                <div class="row">
                    <div class="col-lg-12">
                     
                        <ol class="breadcrumb" id="header-page">
                            <li class="active">
                                <i class="fa fa-pencil-square-o"></i> Raise Alert
                            </li>
                        </ol>
                    </div>
                </div>     
                <div class="row"> 
                	<form name="log-form" id="log-form" class="form-horizontal" role="form" style="margin-left:15px;">
                	<div class="col-md-8">                		
                				<div class="form-group">
                				 <h5>Report date</h5>
                				 <input type="text" id="reportdate" name="reportdate" data-type="date" validationMessage="Please Select Valid Date" style="width:400px;" required />
                				  <span class="k-invalid-msg" data-for="reportdate"></span>                  				
                				</div>
                				<div class="form-group">
                				 <h5>Building Name</h5>
                				 <input id="buildings" style="width: 400px;" name="buildings" validationMessage="Please Select Building" required />   
                				  <span class="k-invalid-msg" data-for="buildings"></span>        				
                				</div>     
                				<div class="form-group">
                				<h5>Alert</h5>
                				<input id="alertId" name="alerts" style="width: 400px;" validationMessage="Please Select Alert" required /> 
                				  <span class="k-invalid-msg" data-for="alerts"></span>     
                				</div>           				               				
                				<div class="form-group">
                				<h5>Alert Date\Time</h5>
                				 <input id="alertdate" name="alertdate" style="width: 400px;" data-type="date" validationMessage="Please Select Valid Alert Time" required />
                				   <span class="k-invalid-msg" data-for="alertdate"></span>   
                				</div>  				               				
                				<div class="form-group">
                				<h5>Severity</h5>
                				  <input id="severity" name="severity" validationMessage="Please Select Severity" style="width: 400px;" required />
                				   <span class="k-invalid-msg" data-for="severity"></span>   
                				  </div> 
                				<div class="form-group">
                				<h5>Description</h5>
                				 <textarea id="description" name="description" style="width: 400px;overflow:auto;" rows="5" validationMessage="Add Alert Description" required></textarea>
                				 <span class="k-invalid-msg" data-for="description"></span>   
                				</div>
                				<div class="form-group">                				
                				 <input type="submit" class="k-primary" data-role="button" value="Raise Alert" />                				
                				</div>
                				           			
                	</div>
              
                </form>
                </div>     
                <div class="row">
               				 <div class="form-group" style="display:none" id="success">   
              				        <div class="alert alert-success " style="width:350px;">              				      
              				        Alert Raised Successfully!!</div>
              				  </div>
              				  <div class="form-group" style="display:none" id="erroralert">   
              				        <div class="alert alert-danger" id="error" style="width:350px;">              				      
              				      </div>
              				  </div>
              				  
                </div>           
             <!-- /.panel-body -->
             </div>      
            <!-- /.container-fluid -->

        </div>
        <!-- /#page-wrapper -->

    </div>
   



    <!-- /#wrapper -->

   <!-- jQuery -->
    <script src="/js/jquery.min.js"></script>
	 <script src="/kendojs/kendo.all.min.js"></script>
    <script src="/kendojs/kendo.timezones.min.js"></script>
	<script src="https://maps.googleapis.com/maps/api/js"></script>
    <!-- Bootstrap Core JavaScript -->
    <script src="/js/bootstrap.min.js"></script>
  	  <!-- Metis Menu Plugin JavaScript -->
    <script src="/js/metisMenu.min.js"></script>
    <!-- Custom Theme JavaScript -->
    <script src="/js/main.js"></script>
	
 
<script>
 $(document).ready(function() {  
 $("#alertId").kendoDropDownList({
 						optionLabel:"Select Alert",
                        dataTextField: "alertName",
                        dataValueField: "alertTypeId",
                        dataSource: {
                            transport: {
                                read: {
                                    dataType: "json",
                                    url: "/getAlertTypes",
                                }
                            }
                        }
                    });
                             
 
$("#reportdate").kendoDatePicker({                  
change: onChange,
close: onClose,
open: onOpen
});

function onOpen() {
 //kendoConsole.log("Open");
}
 function onClose() {
  // kendoConsole.log("Close");
 }
 function onChange() {

 var rpDate=kendo.toString(this.value(), 'MM/dd/yyyy') ;
  //alert(this.value);         
	 $.ajax({		
	  method: 'post',
	  url: '/getBuildings',
	  data: { "reportdate":rpDate }
	})
	.success(function(response){	
	////alert(JSON.stringify(response.buildings));
	var dropdownlist = $("#buildings").data("kendoDropDownList");
	dropdownlist.setDataSource(response.buildings);								
	})
	.error(function(error){
	 });
 }                 
 $("#buildings").kendoDropDownList({  
  optionLabel: "Select Building...",              
  dataTextField: 'buildingName',
  dataValueField: 'buildingId'             
 });   
$("#alertdate").kendoDateTimePicker({                  
	 value: new Date()
});


$("#severity").kendoDropDownList({
	optionLabel:"Select Severity",
    dataTextField: "text",
    dataValueField: "value",
    dataSource: [
     { text: "Very High", value: "Very High" },
        { text: "High", value: "High" },
          { text: "Medium", value: "Medium" },
        { text: "Low", value: "Low" }
        
      
    ]
});
                        
                   
                
});         					 
</script>            
<script>
$(document).ready(function () {
 var validator = $("#log-form").kendoValidator().data("kendoValidator")  ;
  $("#log-form").submit(function(e){
	    e.preventDefault();	  
	 
		 var reportdate = $("#reportdate").data("kendoDatePicker");
		var reportdatevalue = reportdate.value();
	  	var rpDate=kendo.toString(reportdatevalue, 'MM/dd/yyyy') ;	 
	  	var buildingId=$('#buildings').data("kendoDropDownList").value();
		var alertId=$('#alertId').data("kendoDropDownList").value();	 	
	  	var description=$('#description').val();		  
	 	var datepicker = $("#alertdate").data("kendoDateTimePicker");
		var value = datepicker.value();	
	  	var alertdate=kendo.toString(value, 'MM/dd/yyyy hh:mm:ss tt') ;	
	  		
	  	var severity=$('#severity').data("kendoDropDownList").text(); 
	 	//confirm(rpDate+buildingId+description+alertId+alertdate+severity); 	 	
	 	if(validator.validate())
	 	{
	 			  	//alert(alertdate+","+buildingId+","+description+","+alertId);
	 		
			 $.ajax({		
		 	 method: 'post',
			  url: '/submitAlert',
			  data: { "reportDate":alertdate,"buildingId":buildingId,"description":description,"alertTypeId":alertId,"severity":severity}
			})
			.success(function(response){	
								if(response.submitAlert!=undefined)
		         				{	        
		         				$("#erroralert").hide();   				
		         				document.getElementById('success').style.display = "block";
		         				$('#log-form')[0].reset();
		         				}	         				
		         				else{		         				  
		         				$("#success").hide();  	         				      				         							  						
		         				document.getElementById("error").innerHTML = "Error:"+response.error;
		         				document.getElementById('erroralert').style.display = "block";
		         				}					
			})
			.error(function(error){
							$("#success").hide();  	         				      				         							  						
		         				document.getElementById("error").innerHTML = "Error:"+error;
		         				document.getElementById('erroralert').style.display = "block";
			 });
		 }
	  });	    
	  	
});
</script>

</body>
</html>